    {% extends 'base.html.twig' %}

    {% block body %}
        <style>
            .active, .accordion:hover {
                background-color: transparent;
            }

        </style>
        <main id="confirmation">
            <section class="section bg-img">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-10 mx-auto">
                            <ul class="progressbar">
                                <li>Devis</li>
                                <li>Choix du véhicule</li>
                                <li class="active">Confirmation et paiement</li>
                            </ul>
                        </div>

                        <div class="col-lg-9 mx-auto">
                            <div class="card card-wrapper mb-3">
                                <div class="card">
                                    <div class="p-md-5 p-3 mx-auto">
                                        <div class="header-wrapper d-flex flex-wrap justify-content-between mb-3">
                                            <h2>{{ car.name }}</h2>
{#                                            <a href="#">Modifier la sélection</a>#}
                                        </div>
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="card p-3 bg-grey has-shadow">
                                                    <img src="{{ asset('build/uploads/'~ car.getCarImg) }}" alt="" />
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="cars-icons-wrapper d-flex flex-wrap mb-5 mt-3">
                                                    <div class="item">
                                                        <img src="{{ asset('build/page-voiture/voiture-passagers.png') }}" alt="" class="mx-auto" />
                                                        x2
                                                    </div>

                                                    <div class="item">
                                                        <img src="{{ asset('build/page-voiture/voiture-bagages.png') }}" alt="" class="mx-auto" />
                                                        x2
                                                    </div>
                                                    <div class="item">
                                                        <img src="{{ asset('build/page-voiture/voiture-passagers.png') }}" alt="" class="mx-auto" />
                                                        x2
                                                    </div>
                                                    <div class="item">
                                                        <img src="{{ asset('build/page-voiture/voiture-passagers.png') }}" alt="" class="mx-auto" />
                                                    </div>
                                                    <div class="item">
                                                        <img src="{{ asset('build/page-voiture/voiture-passagers.png') }}" alt="" class="mx-auto" />
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-6 mb-3 mb-md-0">
                                                        <div class="card p-2 text-center fw-bold">
                                                            <p class="red">Départ</p>
                                                            <p>{{ name_depart }}</p>
                                                            <p class="red">{{ date_depart|date("d/m/Y") }}</p>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="card p-2 text-center fw-bold">
                                                            <p class="red">Départ</p>
                                                            <p>{{ name_return }}</p>
                                                            <p class="red">{{ date_end|date("d/m/Y") }}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="price mx-auto p-3">Prix total à payer maintenant : <span>{{ price }}€</span></div>
                            </div>

                            <div class="card mb-3">
                                <div class="p-md-5 p-3">
                                    <h3>Equipements supplémentaires</h3>

                                    <div class="table-responsive">
                                        <table class="table table-borderless item-table">
                                            <tr>
                                                <td class="table-img"><img src="{{ asset('build/page-confirmation-commande/siege-auto.png') }}" /></td>
                                                <td class="table-desc">
                                                    <strong>Siège enfant (1 à 3 ans)</strong><br />
                                                    De 12 mois à 3 ans (10 à 15 kg).<br />
                                                    Photo non contractuelle.
                                                </td>
                                                <td>
                                                    <div class="label">Nombre</div>
                                                    <div class="product_quantity clearfix">
                                                        <input id="quantity_input" type="text" pattern="[0-9]*" value="1" />
                                                        <div class="quantity_buttons">
                                                            <div id="quantity_inc_button" class="quantity_inc quantity_control"><i class="fa-solid fa-caret-up" aria-hidden="true"></i></div>
                                                            <div id="quantity_dec_button" class="quantity_dec quantity_control"><i class="fa-solid fa-caret-down" aria-hidden="true"></i></div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="label">Prix</div>
                                                    <span class="price">70 €</span>
                                                </td>
                                                <td class="table-mention">Prix unitaire maximum, à régler sur place</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div class="card bg-grey mb-3">
                                <div class="p-md-5 p-3">
                                    <h3>Identification</h3>
                                    <div class="row">
                                        <div class="col-md-6 pe-lg-5">
                                            <p><span>ASTUCE :</span> Si vous avez déjà commandé chez nous, <a href="#">identifiez-vous</a> avec votre e-mail pour bénéficier de champs pré-remplis. Sinon, indiquez simplement un email pour créer votre compte.</p>
                                        </div>
                                        <div class="col-md-6">
                                                <div class="row mb-3">
                                                    <label for="connexion-email" class="col-sm-3 col-form-label">Email</label>
                                                    <div class="col-sm-9">
                                                        <input type="text" class="form-control" id="connexion-email" placeholder="Votre email" />
                                                    </div>
                                                </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {{ form_start(formOrder) }}
                            <form class="row gx-5">
                                <div class="card bg-grey mb-3">
                                    <div class="p-md-5 p-3">
                                        <h3>Identification</h3>
                                        <div class="row">
                                            <div class="col-md-6">
                                                    <div class="row mb-3">
                                                        <label for="connexion-email" class="col-sm-3 col-form-label">Email</label>
                                                        <div class="col-sm-9">
                                                            {{ form_row(formOrder.email, { 'attr': {'class': 'form-control'} }) }}
                                                        </div>
                                                    </div>
                                                <div class="row mb-3">
                                                    <label for="connexion-email" class="col-sm-3 col-form-label">Mot de passe</label>
                                                    <div class="col-sm-9">
                                                        {{ form_row(formOrder.plainPassword, { 'attr': {'class': 'form-control'} }) }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            <div class="card mb-3">
                                <div class="p-md-5 p-4">
                                        <div class="col-md-6">
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-3 col-form-label">Civilité</label>
                                                <div class="col-sm-9 d-flex align-items-center">
                                                    <div class="form-check form-check-inline">
                                                        {{ form_row(formOrder.customer_type, { 'attr': {'class': 'form-check-input'} }) }}                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="w-100"></div>

                                        <div class="col-md-6">
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-3 col-form-label">Nom</label>
                                                <div class="col-sm-9">
                                                    {{ form_row(formOrder.customer_name, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-4 col-form-label">Nom de jeune fille</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.customer_old_name, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-4 col-form-label">Date de naissance</label>
                                                <div class="col-sm-8 date-select">
                                                    {{ form_row(formOrder.birth_date) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-4 col-form-label">Ville de naissance</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.birth_city, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-5 col-form-label">Numéro de passeport</label>
                                                <div class="col-sm-7">
                                                    {{ form_row(formOrder.passport_number, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-4 col-form-label">Date de délivrance</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.passport_date) }}
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-3 col-form-label">Nationalité</label>
                                                <div class="col-sm-9">
                                                    {{ form_row(formOrder.nationality, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-3 col-form-label">Prénom</label>
                                                <div class="col-sm-9">
                                                    {{ form_row(formOrder.customer_username, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-4 col-form-label">Pays de naissance</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.birth_country, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-6 col-form-label">Code postal de naissance</label>
                                                <div class="col-sm-6">
                                                    {{ form_row(formOrder.birth_postal, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-3 col-form-label">Profession</label>
                                                <div class="col-sm-9">
                                                    {{ form_row(formOrder.profession, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-4 col-form-label">Lieu de délivrance</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.passport_place, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row pb-3">
                                                <label for="inputEmail4" class="col-sm-4 col-form-label">Raison</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.reason, { 'attr': {'class': 'form-control form-control-sm'} }) }}
                                                </div>
                                            </div>
                                        </div>
                                </div>
                            </div>

                            <div class="card bg-grey mb-3">
                                <div class="p-md-5 p-3">
                                    <h3>Informations de vol</h3>
                                    <div class="row">
                                        <div class="col-md-6 pe-lg-5">
                                            <p><span>ASTUCE :</span> Votre numéro de vol permet de garantir votre livraison en cas de retard de votre avion ou de changement de terminal lors de votre arrivée.</p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 pe-lg-5">
                                                <div class="row mb-3">
                                                    <label for="connexion-email" class="col-sm-4 col-form-label">Numéro de vol</label>
                                                    <div class="col-sm-8">
                                                        {{ form_row(formOrder.number_plane, { 'attr': {'class': 'form-control'} }) }}
                                                    </div>
                                                </div>
                                        </div>
                                        <div class="col-md-6">
                                                <div class="row mb-3">
                                                    <label for="connexion-email" class="col-sm-4 col-form-label">Lieux d'arrivé </label>
                                                    <div class="col-sm-8">
                                                        {{ form_row(formOrder.place_plane, { 'attr': {'class': 'form-control'} }) }}
                                                    </div>
                                                </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="row mb-3">
                                                <label for="connexion-email" class="col-sm-4 col-form-label">Heure d’arrivé</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.planeDate2) }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row px-2 g-4">
                                <div class="col-md-6 pe-md-2 px-0">
                                    <div class="card p-md-5 p-4">
                                        <h3 class="red mb-3">Coordonnées en France</h3>
                                            <div class="row mb-3">
                                                <div class="col-sm-4 px-0">
                                                    <label for="exampleFormControlTextarea1" class="w-100 col-form-label">Adresse</label>
                                                </div>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.adress, { 'attr': {'class': 'form-control'} }) }}                                                </div>
                                            </div>
                                            <div class="row mb-3">
                                                <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Ville</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.city, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row mb-3">
                                                <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Code postal</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.postal_code, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row mb-3">
                                                <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Pays</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.country, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row mb-3">
                                                <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Téléphone</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.phone, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                    </div>
                                </div>
                                <div class="col-md-6 ps-md-2 px-0">
                                    <div class="card p-md-5 p-4">
                                        <h3 class="red mb-3">Coordonnées permanentes</h3>
                                            <div class="row mb-3">
                                                <div class="col-sm-4 px-0">
                                                    <label for="exampleFormControlTextarea1" class="w-100 col-form-label">Adresse</label>
                                                </div>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.adress_no_ue, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row mb-3">
                                                <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Ville</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.adress_city_hue, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                            <div class="row mb-3">
                                                <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Code postal</label>
                                                <div class="col-sm-8">
                                                    {{ form_row(formOrder.adress_code_hue, { 'attr': {'class': 'form-control'} }) }}
                                                </div>
                                            </div>
                                        <div class="row mb-3">
                                            <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Pays</label>
                                            <div class="col-sm-8">
                                                {{ form_row(formOrder.adress_country_hue, { 'attr': {'class': 'form-control'} }) }}
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Commentaire</label>
                                            <div class="col-sm-8">
                                                {{ form_row(formOrder.comment, { 'attr': {'class': 'form-control form-control-lg textarena_large'} }) }}
                                            </div>
                                        </div>
                                       {#     <div class="row mb-3">
                                                <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Téléphone</label>
                                                <div class="col-sm-8">
                                                    <input type="text" class="form-control" id="connexion-email" />
                                                </div>
                                            </div>
                                            <div class="row">
                                                <label for="exampleFormControlInput1" class="col-sm-4 col-form-label">Mobile</label>
                                                <div class="col-sm-8">
                                                    <input type="text" class="form-control" id="connexion-email" />
                                                </div>
                                            </div>#}
                                    </div>
                                </div>
                            </div>

                            <div class="row legal-check">
                                <div class="col-12 px-3 my-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="" id="defaultCheck1" />
                                        <label class="form-check-label" for="defaultCheck1">Je reconnais avoir pris connaissance des conditions générales de vente Key Services et les accepter</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="" id="defaultCheck2" />
                                        <label class="form-check-label" for="defaultCheck2">Je souhaite recevoir les offres promotionnelles de Key Services et de ses partenaires</label>
                                    </div>
                                </div>
                                <div class="mb-4">
                                    <button class="btn btn-primary px-4" type="submit">RÉSERVER ET PAYER</button>
                                </div>
                            </div>
                        </div>
                    </div>

                        {{ form_end(formOrder) }}

                        <div class="col-lg-3">
                            <div class="card bg-blue-transparent p-4 mb-3">
                                <h3 class="mb-3">Détail du prix :</h3>
                                <table class="table table-borderless price-table">
                                    <tbody>
                                    <tr>
                                        <td>Forfait {{ nb_days}} jours :</td>
                                        <td>{{ price }} €</td>
                                    </tr>
                                    <tr>
                                        <td>Livraison du véhicule :</td>
                                        <td>
                                            {% if price_depart == 0 %}
                                                {{ 'form_order.free'|trans({}, 'messages') }} !
                                            {% else %}
                                                {{ price_depart }}€
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Retour du véhicule :</td>
                                        <td>
                                            {% if price_return == 0 %}
                                                {{ 'form_order.free'|trans({}, 'messages') }} !
                                            {% else %}
                                                {{ price_return }}€
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>TOTAL :</td>
                                        <td>{{ price }}€</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="card bg-blue-transparent p-4">
                                <h3 class="mb-3">Ce prix inclut</h3>
                                <ul class="check-list">
                                    <li>Un véhicule neuf</li>
                                    <li>Le kilométrage illimité</li>
                                    <li>L’assurance multirisques sans franchise</li>
                                    <li>L’assistance 7j / 7 et 24h / 24</li>
                                    <li>Les frais de livraison et de restitution</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        {{ include('modal/loginModal.html.twig') }}

        <script>
            function ItemCalcule() {
                let x = document.getElementById("priceAjax");
                let nbPrice = parseInt({{ price }});
                let arrayItems = {{ car.getItems|length }};
                let total = 0;
                let libelles = [];
                let nbItems = [];
                let undif = null;

                {% for item in car.getItems %}
                let value{{ item.getId }} = document.getElementById('item-'+{{ item.getId }}).value;

                let nb{{ item.getId }} = parseInt({{ item.getPrice }}) * value{{ item.getId }};
                undif = parseInt(value{{ item.getId }});
                if (undif !== 0) {
                    libelles.push('{{ item.getLibelle }}');
                    nbItems.push(value{{ item.getId }});
                }

                {% endfor %}

                if (arrayItems === 1) {
                    total = nbPrice + nb1;
                }else if (arrayItems > 1) {
                    total = nbPrice + nb1 + nb2;
                }else if (arrayItems > 2) {
                    total = nbPrice + nb1 + nb2 + nb3;
                }else if (arrayItems > 3) {
                    total = nbPrice + nb1 + nb2 + nb3 + nb4;
                }

                $.ajax({
                    url:{{ path('priceAjax') }},
                    type:"POST",
                    dataType:"json",
                    data: {price: total},
                    success: function(data2){
                        console.log(data2);
                        x.style.display = "none";
                        $('#results').html(data2 + '€'); // affichage des résultats dans le bloc
                        $('#item').html('-'+libelles); // affichage des résultats dans le bloc
                    }
                });

                $.ajax({
                    url:{{ path('itemsAjax') }},
                    type:"POST",
                    dataType:"json",
                    data: {libelleItems: libelles},
                    success: function(libelles){
                        console.log(libelles);
                    }
                });

            $.ajax({
                url:{{ path('countItemAjax') }},
                type:"POST",
                dataType:"json",
                data: {countItem: nbItems},
                success: function(nbItems){
                    console.log('ok sloth');
                    console.log(nbItems);
                }
            });
        }
            function ClickModal() {
                let x = document.getElementById("myModal");
                let y = document.getElementById("modalClose");
                x.style.display = "block";

            }

            function CloseModal() {
                let x = document.getElementById("myModal");
                x.style.display = "none";
            }
        </script>

    {% endblock %}
